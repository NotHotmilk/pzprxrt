/*! @license pzpr.js v1375cc80 (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["triparty"],{MouseEvent:{inputModes:{edit:["mark-circle","mark-triangle","mark-rect","clear"],play:["mark-circle","mark-triangle","mark-rect","objblank","clear"]},mouseinput_other:function(){if(this.mousestart)switch(this.inputMode){case"mark-circle":this.inputFixedNumber(1);break;case"mark-triangle":this.inputFixedNumber(2);break;case"mark-rect":this.inputFixedNumber(3)}},mouseinput_auto:function(){this.puzzle.playmode&&("left"===this.btn?(this.mousestart||this.mousemove)&&this.dragDots():"right"===this.btn&&this.mousemove&&this.inputDot()),this.mouseend&&this.notInputted()&&(this.mouseCell=null,this.inputqnum())},dragDots:function(){var e=this.getcell();if(!e.isnull&&e!==this.mouseCell&&-1===e.qnum){if(this.mouseCell.isnull)return-1!==e.anum?void 0:(this.inputData=1===e.qsub?-2:10,void(this.mouseCell=e));-2===this.inputData?(e.setAnum(-1),e.setQsub(1)):10===this.inputData&&(e.setAnum(-1),e.setQsub(0)),(this.mouseCell=e).draw()}},inputDot:function(){var e=this.getcell();e.isnull||e===this.mouseCell||-1!==e.qnum||(null===this.inputData&&(this.inputData=1===e.qsub?0:1),e.setAnum(-1),e.setQsub(1===this.inputData?1:0),(this.mouseCell=e).draw())}},KeyEvent:{enablemake:!0,enableplay:!0,keyinput:function(e){this.key_hakoiri(e)},key_hakoiri:function(e){"1"===e||"q"===e||"a"===e||"z"===e?e="1":"2"===e||"w"===e||"s"===e||"x"===e?e="2":"3"===e||"e"===e||"d"===e||"c"===e?e="3":"4"!==e&&"r"!==e&&"f"!==e&&"v"!==e&&"5"!==e&&"t"!==e&&"g"!==e&&"b"!==e||(e=" "),this.key_inputqnum(e)}},Cell:{numberAsObject:!0,enableSubNumberArray:!0,maxnum:3},Board:{hasborder:1},AreaRoomGraph:{enabled:!0},Graphic:{enablebcolor:!0,paint:function(){this.drawBGCells(),this.drawTargetSubNumber(),this.drawGrid(),this.drawDotCells(),this.drawQnumMarks(),this.drawHatenas(),this.drawSubNumbers(),this.drawSolverQnumMarks(),this.drawChassis(),this.drawCursor()},getNumberTextCore:function(e){return 0<e?"○△◻"[e-1]:null},drawQnumMarks:function(){for(var e=this.vinc("cell_mark","auto"),t=(e.lineWidth=Math.max(this.cw/18,2),.3*this.cw),i=.26*this.cw,n=this.range.cells,r=0;r<n.length;r++){var s=n[r],u=(e.vid="c_mk_"+s.id,e.strokeStyle=-1!==s.qnum?this.getQuesNumberColor(s):this.getAnsNumberColor(s),s.bx*this.bw),o=s.by*this.bh;switch(s.getNum()){case 1:e.strokeCircle(u,o,t);break;case 2:e.beginPath(),e.setOffsetLinePath(u,o,0,-i,-t,i,t,i,!0),e.stroke();break;case 3:e.strokeRectCenter(u,o,t,t);break;default:e.vhide()}}},drawSolverQnumMarks:function(){for(var e=this.vinc("cell_mark_solver","auto"),t=(e.lineWidth=Math.max(this.cw/18,2),.3*this.cw),i=.26*this.cw,n=this.range.cells,r=0;r<n.length;r++){var s=n[r],u=(e.vid="c_mk_solver_"+s.id,e.strokeStyle=this.getSolverAnsNumberColor(s),s.bx*this.bw),o=s.by*this.bh;switch(s.qansBySolver){case 1:e.strokeCircle(u,o,t);break;case 2:e.beginPath(),e.setOffsetLinePath(u,o,0,-i,-t,i,t,i,!0),e.stroke();break;case 3:e.strokeRectCenter(u,o,t,t);break;default:e.vhide()}}}},Encode:{decodePzpr:function(e){this.decodeNumber10()},encodePzpr:function(e){this.encodeNumber10()}},FileIO:{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeCellAnumsub()},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeCellAnumsub()}},AnsCheck:{checklist:["checkAroundMarks@hakoiri","checkThreeTypesInLine@alter","checkOverFourMarksInBox","checkDifferentNumberInRoom","checkAlternatingLines@alter","checkConnectNumber@hakoiri","checkAllMarkInBox","checkNoTypesInLine@alter"],checkOverFourMarksInBox:function(){this.checkAllBlock(this.board.roommgr,function(e){return e.isNum()},function(e,t,i,n){return i<=3},"bkNumGt3")},checkAllMarkInBox:function(){this.checkAllBlock(this.board.roommgr,function(e){return e.isNum()},function(e,t,i,n){return 3<=i},"bkNumLt3")},checkAroundMarks:function(){this.checkAroundCell(function(e,t){return 0<=e.getNum()&&e.getNum()===t.getNum()},"nmAround")},checkAlternatingLines:function(){var r=this.board,s=!1;this.checkRowsCols(function(e){for(var t=null,i=0;i<e.length;i++){var n=e[i];if(n.isNum()){if(t&&t.getNum()===n.getNum()){if(this.checkOnly)return!1;s=!0,r.cellinside(t.bx,t.by,n.bx,n.by).seterr(1)}t=n}}return!0},"nmDupRow"),s&&this.failcode.add("nmDupRow")},checkThreeTypesInLine:function(){this.checkRowsCols(function(e){var t=[!1,!1,!1];return e.each(function(e){e=e.getNum();1<=e&&e<=3&&(t[e-1]=!0)}),!(t[0]&&t[1]&&t[2])||(e.seterr(1),!1)},"nmTripRow")},checkNoTypesInLine:function(){this.checkRowsCols(function(e){return!(e.filter(function(e){return e.isNum()}).length<2)||(e.seterr(1),!1)},"nmMissRow")}}});